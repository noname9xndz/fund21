function getRootSvg(){for(var e=document.body.childNodes,t=e.length,n=0;n<t;n++){var i=e[n];if("svg"===i.tagName||"SVG"===i.tagName)return i}return!1}function createRootSvg(){var e=document.createElementNS(NAMESPACE_SVG,"svg");return e.setAttribute("height","0"),document.body.appendChild(e),e}function createSvgUse(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElementNS(NAMESPACE_SVG,"svg");for(var i in t)n.setAttribute(i,t[i]);var o=document.createElementNS(NAMESPACE_SVG,"use");return o.setAttributeNS(NAMESPACE_XLINK,"xlink:href","#"+e),n.appendChild(o),n}function changeSvgIcon(e,t){e.firstChild.setAttributeNS(NAMESPACE_XLINK,"xlink:href","#"+t)}function getSvgIcon(e){return e.firstChild.getAttributeNS(NAMESPACE_XLINK,"href").slice(1)}function rgbaToColorMatrix(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=function(e){return Math.round(e/255*10)/10};return"0 0 0 0 "+o(e)+" 0 0 0 0 "+o(t)+" 0 0 0 0 "+o(n)+" 0 0 0 1 "+o(i)}function getIdForSvgColorFilter(e,t,n){return"__bunny_filter_"+e+"_"+t+"_"+n+"_"+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}function createOrGetSvgColorFilter(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=getIdForSvgColorFilter(e,t,n,i),r=getRootSvg();if(r===!1&&(r=createRootSvg()),!document.getElementById(o)){var a=document.createElementNS("http://www.w3.org/2000/svg","filter");a.setAttribute("id",o),a.innerHTML='<feColorMatrix type="matrix" values="'+rgbaToColorMatrix(e,t,n,i)+'" />',r.appendChild(a)}return o}function applySvgColorFilterToElement(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=createOrGetSvgColorFilter(t,n,i,o);e.style.filter="url(#"+r+")"}void 0===Object.getOwnPropertyDescriptor(Element.prototype,"classList")&&Object.defineProperty(Element.prototype,"classList",Object.getOwnPropertyDescriptor(HTMLElement.prototype,"classList"));var NAMESPACE_SVG="http://www.w3.org/2000/svg",NAMESPACE_XLINK="http://www.w3.org/1999/xlink",SpinnerConfig={icon:"spinner",className:"i-spinner",tagNameFade:"fade",classNameFade:null,classNameFadeShow:"show",animationDuration:600},Spinner={Config:SpinnerConfig,insertSpinner:function(e,t){e.appendChild(t)},removeSpinner:function(e,t){e.removeChild(t)},getSpinner:function(e){return e.__bunny_spinner||!1},has:function(e){return void 0!==e.__bunny_spinner},show:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"SVG"===e.tagName||"svg"===e.tagName?(e.__bunny_spinner=getSvgIcon(e),changeSvgIcon(e,this.Config.icon),e.classList.add(this.Config.className)):(t&&(e.__bunny_spinner_text=e.innerHTML,e.textContent=""),e.__bunny_spinner=createSvgUse(this.Config.icon,{class:this.Config.className}),this.insertSpinner(e,e.__bunny_spinner))},hide:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"SVG"===e.tagName||"svg"===e.tagName?(e.classList.remove(this.Config.className),changeSvgIcon(e,e.__bunny_spinner)):(this.removeSpinner(e,e.__bunny_spinner),t&&(e.innerHTML=e.__bunny_spinner_text,delete e.__bunny_spinner_text)),delete e.__bunny_spinner},toggle:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.has(e)?(this.hide(e,t),!0):(this.show(e,t),!1)},fadePage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(i){if(e.getFade())i();else{var o=document.createElement(e.Config.tagNameFade);null!==e.Config.classNameFade&&o.classList.add(e.Config.classNameFade);var r=document.createElement("div");r.classList.add("fade"),n&&r.classList.add(n),o.appendChild(r),document.body.appendChild(o),setTimeout(function(){null!==t&&(r.textContent=t,r.classList.add("in")),e.toggle(o),o.classList.add(e.Config.classNameFadeShow),setTimeout(function(){i()},e.Config.animationDuration)},0)}})},getFade:function(){return document.getElementsByTagName(this.Config.tagNameFade)[0]||!1},getFadeIcon:function(){return this.getSpinner(this.getFade())},getFadeText:function(){return this.getFade().getElementsByTagName("div")[0]},unfadePage:function(){var e=this;return new Promise(function(t){var n=e.getFade();n?(n.classList.remove(e.Config.classNameFadeShow),setTimeout(function(){document.body.removeChild(n),t()},e.Config.animationDuration)):t()})},setFadeIcon:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getFadeIcon();n.classList.remove(this.Config.className),changeSvgIcon(n,e),t&&n.classList.add(t)},setFadeText:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getFadeText();n.classList.remove("in"),setTimeout(function(){n.textContent=e,t&&n.setAttribute("class",t),n.classList.add("in")},300)}};Object.assign(AutocompleteConfig,{iconSearch:"search"}),Object.assign(AutocompleteUI,{getIcon:function(e){return e.getElementsByTagName("svg")[0]},createIcon:function(){return createSvgUse(this.Config.iconSearch)},insertIcon:function(e,t){e.appendChild(t)}}),Object.assign(Autocomplete,{initIcons:function(e){var t=this,n=this.UI.createIcon();this.UI.insertIcon(e,n),this.onBeforeUpdate(e,function(){t.showSpinner(e)}),this.onUpdate(e,function(n,i){t.hideSpinner(e)})},showSpinner:function(e){Spinner.toggle(this.UI.getIcon(e))},hideSpinner:function(e){Spinner.toggle(this.UI.getIcon(e))}});